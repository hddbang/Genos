# åºåˆ—åŸºå‡†æµ‹è¯•å·¥å…· (Seq Benchmarks)

ä¸€ä¸ªä¸“é—¨ç”¨äºè¯„ä¼°è¯­è¨€æ¨¡å‹åœ¨ç”Ÿç‰©ä¿¡æ¯å­¦åºåˆ—ä»»åŠ¡ä¸Šæ€§èƒ½çš„ç»¼åˆåŸºå‡†æµ‹è¯•æ¡†æ¶ã€‚

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„åŸºå‡†æµ‹è¯•å¹³å°ï¼Œç”¨äºè¯„ä¼°transformeræ¶æ„çš„è¯­è¨€åºåˆ—æ¨¡å‹åœ¨ç”Ÿç‰©åºåˆ—åˆ†æä»»åŠ¡ä¸Šçš„è¡¨ç°ã€‚æ”¯æŒDNAã€RNAã€è›‹ç™½è´¨ç­‰å¤šç§ç”Ÿç‰©åºåˆ—çš„åˆ†ç±»å’Œå›å½’ä»»åŠ¡ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ§¬ **å¤šæ ·åŒ–æ•°æ®é›†æ”¯æŒ**: åŒ…å«50+ä¸ªç”Ÿç‰©ä¿¡æ¯å­¦æ•°æ®é›†
- ğŸ”¬ **å¤šç§ä»»åŠ¡ç±»å‹**: æ”¯æŒåˆ†ç±»ã€å›å½’å’Œå¤šæ ‡ç­¾é¢„æµ‹ä»»åŠ¡
- ğŸš€ **é«˜æ•ˆå¹¶è¡Œå¤„ç†**: æ”¯æŒå¤šGPUå¹¶è¡Œè®¡ç®—å’Œä»»åŠ¡è°ƒåº¦
- ğŸ“Š **å®Œæ•´è¯„ä¼°æµç¨‹**: ä»åµŒå…¥æå–åˆ°ç»“æœåˆ†æçš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ
- ğŸ“ˆ **å¯è§†åŒ–æŠ¥å‘Š**: è‡ªåŠ¨ç”Ÿæˆè¯¦ç»†çš„æ€§èƒ½æŠ¥å‘Šå’Œå›¾è¡¨
- ğŸ”§ **çµæ´»é…ç½®**: é€šè¿‡YAMLé…ç½®æ–‡ä»¶è½»æ¾å®šåˆ¶å®éªŒå‚æ•°


## ğŸ“‹ æ”¯æŒçš„æ•°æ®é›†ä¿¡æ¯

| æ•°æ®é›†åç§° | ä»»åŠ¡ç±»å‹ | æ ·æœ¬æ•° | åºåˆ—é•¿åº¦ | ç±»åˆ«æ•° | æ•°æ®åˆ’åˆ† | ç”Ÿç‰©å­¦æ„ä¹‰ |
|-----------|---------|--------|----------|--------|----------|------------|
| **Genomic Benchmark** |
| `demo_coding_vs_intergenomic_seqs` | åˆ†ç±» | 100,000 | 200 | 2 | train/test | åŒºåˆ†ç¼–ç åºåˆ—ä¸åŸºå› é—´åŒºåŸŸï¼Œè¯„ä¼°æ¨¡å‹å¯¹åŠŸèƒ½åŸºå› åŒºåŸŸçš„è¯†åˆ«èƒ½åŠ› |
| `human_enhancers_cohn` | åˆ†ç±» | 27,791 | 500 | 2 | train/test | äººç±»å¢å¼ºå­è¯†åˆ«ï¼Œç”¨äºè¯„ä¼°è½¬å½•è°ƒæ§å…ƒä»¶é¢„æµ‹æ€§èƒ½ |
| `human_ocr_ensembl` | åˆ†ç±» | 174,756 | 71-593 | 2 | train/test | å¼€æ”¾æŸ“è‰²è´¨åŒºåŸŸè¯†åˆ«ï¼Œé¢„æµ‹æŸ“è‰²è´¨å¯åŠæ€§å’Œè½¬å½•æ´»è·ƒåŒºåŸŸ |
| **Nucleotide Transformer** |
| `splice_sites_all` | åˆ†ç±» | 30,000 | 400 | 3 | train/test | å‰ªæ¥ä½ç‚¹é¢„æµ‹ï¼ˆä¾›ä½“/å—ä½“/éå‰ªæ¥ï¼‰ï¼Œè¯„ä¼°RNAå‰ªæ¥æœºåˆ¶ç†è§£ |
| `H3` | åˆ†ç±» | 14,965 | 290-500 | 2 | train/test | H3ç»„è›‹ç™½ä¿®é¥°é¢„æµ‹ï¼Œè¯„ä¼°è¡¨è§‚é—ä¼ æ ‡è®°è¯†åˆ«èƒ½åŠ› |
| `H3K36me3` | åˆ†ç±» | 34,880 | 310-500 | 2 | train/test | H3K36me3ä¸‰ç”²åŸºåŒ–ä¿®é¥°é¢„æµ‹ï¼Œè¯„ä¼°è½¬å½•ä¼¸é•¿ç›¸å…³æ ‡è®°è¯†åˆ« |
| **é•¿ç¨‹åŸºå‡†æ•°æ®é›† (Long Range Benchmark - LRB)** |
| `regulatory_element_promoter_8K` | åˆ†ç±» | 60,000 | 8,192 | 2 | train/test/eval | é•¿ç¨‹å¯åŠ¨å­è¯†åˆ«ï¼Œè¯„ä¼°è½¬å½•èµ·å§‹åŒºåŸŸé¢„æµ‹æ€§èƒ½ |
| `regulatory_element_enhancer_8K` | åˆ†ç±» | 60,000 | 8,192 | 2 | train/test/eval | é•¿ç¨‹å¢å¼ºå­è¯†åˆ«ï¼Œè¯„ä¼°è¿œç¨‹è°ƒæ§å…ƒä»¶é¢„æµ‹èƒ½åŠ› |
| `variant_effect_causal_eqtl_8K` | åˆ†ç±» | 38,862 | 8,192 | 2 | train/test/eval | å› æœæ€§eQTLå˜å¼‚é¢„æµ‹ï¼Œè¯„ä¼°åŸºå› è¡¨è¾¾è°ƒæ§å˜å¼‚è¯†åˆ«ï¼ˆåŒåºåˆ—å¯¹æ¯”ï¼‰ |
| `variant_effect_pathogenic_clinvar_8K` | åˆ†ç±» | 31,018 | 8,192 | 2 | train/test/eval | è‡´ç—…æ€§å˜å¼‚é¢„æµ‹ï¼Œè¯„ä¼°ä¸´åºŠç›¸å…³æœ‰å®³çªå˜è¯†åˆ«ï¼ˆåŒåºåˆ—å¯¹æ¯”ï¼‰ |
| `bulk_rna_expression_8K` | å›å½’ | 23,817 | 8,192 | 218ç»´ | train/test/eval | å¤§é‡RNAè¡¨è¾¾é¢„æµ‹ï¼Œè¯„ä¼°åŸºå› è¡¨è¾¾æ°´å¹³å®šé‡é¢„æµ‹èƒ½åŠ› |
| **å˜å¼‚çƒ­ç‚¹æ•°æ®é›† (Variant Hotspot)** |
| `CPC_1024` | åˆ†ç±» | 828,039 | 1,024 | 2 | train/test/eval | ç¼–ç èƒ½åŠ›é¢„æµ‹-çŸ­åºåˆ—ï¼Œè¯„ä¼°è›‹ç™½è´¨ç¼–ç æ½œèƒ½è¯†åˆ« |
| `CPC_8192` | åˆ†ç±» | 62,729 | 8,192 | 2 | train/test/eval | ç¼–ç èƒ½åŠ›é¢„æµ‹-ä¸­ç­‰åºåˆ—ï¼Œè¯„ä¼°é•¿è½¬å½•æœ¬ç¼–ç æ½œèƒ½ |
| `CPC_32768` | åˆ†ç±» | 15,391 | 32,768 | 2 | train/test/eval | ç¼–ç èƒ½åŠ›é¢„æµ‹-é•¿åºåˆ—ï¼Œè¯„ä¼°å¤æ‚è½¬å½•æœ¬ç¼–ç è¯†åˆ« |
| `CPC_131072` | åˆ†ç±» | 3,825 | 131,072 | 2 | train/test/eval | ç¼–ç èƒ½åŠ›é¢„æµ‹-è¶…é•¿åºåˆ—ï¼Œè¯„ä¼°å…¨é•¿è½¬å½•æœ¬ç¼–ç åˆ†æ |
| `HPRC_1024` | åˆ†ç±» | 246,790 | 1,024 | 2 | train/test/eval | äººç±»æ³›åŸºå› ç»„å˜å¼‚-çŸ­åºåˆ—ï¼Œè¯„ä¼°ç¾¤ä½“é—ä¼ å˜å¼‚æ¨¡å¼ |
| `HPRC_8192` | åˆ†ç±» | 30,550 | 8,192 | 2 | train/test/eval | äººç±»æ³›åŸºå› ç»„å˜å¼‚-ä¸­ç­‰åºåˆ—ï¼Œè¯„ä¼°ç»“æ„å˜å¼‚è¯†åˆ« |
| `HPRC_32768` | åˆ†ç±» | 7,375 | 32,768 | 2 | train/test/eval | äººç±»æ³›åŸºå› ç»„å˜å¼‚-é•¿åºåˆ—ï¼Œè¯„ä¼°å¤§å°ºåº¦ç»“æ„å˜å¼‚ |
| `HPRC_131072` | åˆ†ç±» | 1,926 | 131,072 | 2 | train/test/eval | äººç±»æ³›åŸºå› ç»„å˜å¼‚-è¶…é•¿åºåˆ—ï¼Œè¯„ä¼°å¤æ‚ç»“æ„é‡æ’è¯†åˆ« |
| **ä¸‹æ¸¸ä»»åŠ¡æ•°æ®é›†** |
| `Human_classify_8192` | åˆ†ç±» | 28994 | 8192 | 3 | train/test/eval | äººç§åˆ†ç±»ï¼ŒåŸºäºåŸºå› ç»„åºåˆ—è¿›è¡Œæ¬§æ´²ã€éæ´²ã€ä¸œäºšäººç§çš„åŒºåˆ† |
| `Human_classify_32768` | åˆ†ç±» | 29045 | 32768 | 3 | train/test/eval | äººç§åˆ†ç±»ï¼ŒåŸºäºåŸºå› ç»„åºåˆ—è¿›è¡Œæ¬§æ´²ã€éæ´²ã€ä¸œäºšäººç§çš„åŒºåˆ† |
| `Human_classify_131072` | åˆ†ç±» | 29410 | 131072 | 3 | train/test/eval | äººç§åˆ†ç±»ï¼ŒåŸºäºåŸºå› ç»„åºåˆ—è¿›è¡Œæ¬§æ´²ã€éæ´²ã€ä¸œäºšäººç§çš„åŒºåˆ† |
| `Human_classify_1048576` | åˆ†ç±» | 28802 | 1048576 | 3 | train/test/eval | äººç§åˆ†ç±»ï¼ŒåŸºäºåŸºå› ç»„åºåˆ—è¿›è¡Œæ¬§æ´²ã€éæ´²ã€ä¸œäºšäººç§çš„åŒºåˆ† |


## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

**å®‰è£…ä¾èµ–**:
   ```bash
   pip install -r requirements.txt
   ```

### åŸºæœ¬ä½¿ç”¨
1. **ä¿®æ”¹configå¹¶è¿è¡Œæµ‹è¯•**:
   ```bash
   python benchmarks.py --config config.yaml
   ```

2. **configå‚æ•°è¯´æ˜**:
- æ¨¡å‹ä¿¡æ¯ç›¸å…³
   ```yaml
   # å¡«å†™æ¨¡å‹è·¯å¾„ï¼Œç”¨äºembeddingæå–ï¼Œæ¨¡å‹åç§°å°†ä½¿ç”¨æ¨¡å‹è·¯å¾„æœ€åä¸€å±‚æ–‡ä»¶å¤¹çš„è·¯å¾„
   model_path: "/model/mode_path"
   # è¯¥æ¡†æ¶ä¸­æˆ–è®¸ä¸ä¸€å®šæ”¯æŒéƒ¨åˆ†æ¨¡å‹ç±»çš„embeddingï¼Œå¦‚æœæ— æ³•æ­£ç¡®åŠ è½½æ¨¡å‹æå–embeddingï¼Œè¯·è‡ªè¡Œæå–embeddingï¼Œå°†model_pathå‚æ•°åˆ é™¤ï¼Œå¡«å†™model_nameå’Œnum_layersï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼è§åæ–‡
   # å¦‚æœæ¨¡å‹å’Œæ¨¡å‹å±‚æ•°å¯ä»¥æ­£ç¡®è¯»å–ï¼Œåˆ™åˆ é™¤model_nameå’Œnum_layersä¸¤ä¸ªå‚æ•°
   # æ¨¡å‹åç§°
   model_name: "model_name"
   # æ¨¡å‹å±‚æ•°
   num_layers: 12
   ```
- æµ‹è¯•æ•°æ®é›†ç›¸å…³
   ```yaml
   # æ•°æ®é›†è·¯å¾„
   dataset_path: "/data/dataset_path"
   # æ•°æ®é›†ä¿¡æ¯è·¯å¾„
   datasets_feature_path: "benchmarks/datasets_info.yaml"
   # æµ‹è¯•æ•°æ®é›†ï¼Œå¡«å†™éœ€è¦æµ‹è¯•çš„æ•°æ®é›†ï¼Œå¦‚æœéœ€è¦æµ‹è¯•è‡ªå®šä¹‰æ•°æ®é›†ï¼Œæ·»åŠ è‡ªå®šä¹‰æ•°æ®é›†æ–¹å¼è¯¦è§åæ–‡
   eval_datasets:
     - demo_coding_vs_intergenomic_seqs
     - human_enhancers_cohn
     - splice_sites_all
   ```
- ä»»åŠ¡è°ƒåº¦ç›¸å…³
    ```yaml
    # GPUé…ç½®ï¼Œä»¥åˆ—è¡¨å½¢å¼å¡«å†™éœ€ä½¿ç”¨çš„gpuåºå·ï¼Œå¦‚æœä¸å†™ï¼Œé»˜è®¤ä½¿ç”¨æ‰€æœ‰å¯æ£€æµ‹åˆ°çš„gpu
    gpu_list: [0,1]
    # éœ€è¯„è¯„æµ‹å±‚ï¼Œå¦‚éœ€è¯„æµ‹æ¨¡å‹ç‰¹å®šå±‚ï¼Œä»¥åˆ—è¡¨å½¢å¼å¡«å†™è¦è¯„æµ‹çš„å±‚ï¼Œå¦‚ä¸å¡«å†™ï¼Œåˆ™é»˜è®¤è¯„æµ‹æ‰€æœ‰å±‚
    layer_to_eval: [12]
    # ä»¥ä¸‹ä¸ºå¹¶è¡Œä»»åŠ¡åˆ†é…ç›¸å…³ï¼Œå¡«å†™é€»è¾‘è¯¦è§åæ–‡
    # æ¯ä¸ªGPUä¸Šå¯ä»¥è¿è¡Œä»»åŠ¡çš„æ€»æƒé‡æ•°
    process_power_per_gpu: 5
    # embeddingæå–ä»»åŠ¡å ç”¨æƒé‡
    embedding_process_power: 4
    # evalä»»åŠ¡å ç”¨æƒé‡
    eval_process_power: 1
    # æå–embeddingæ—¶æ•°æ®é›†åˆ†å‰²ç²’åº¦
    embedding_extract_split: 50000
   ```
- embeddingæå–ä»»åŠ¡ç›¸å…³
    ```yaml
    # embeddingç»“æœå­˜æ”¾è·¯å¾„ï¼Œembeddingå ç”¨ç©ºé—´è¾ƒå¤§ï¼Œä»»åŠ¡ç»“æŸåè®°å¾—åŠæ—¶åˆ é™¤
    embedding_output_dir: "/results/embeddings"
    # embeddingæå–çš„batch size
    batch_size: 8
   ```
- è·å¾—embeddingä¹‹åï¼Œåˆ†ç±»æˆ–å›å½’ç›¸å…³

    ```yaml
    # é»˜è®¤åˆ†ç±»å™¨ç±»å‹ï¼Œç›®å‰å¯æ”¯æŒMLPï¼ŒXGBï¼ˆxgboostï¼‰ï¼ŒRFï¼ˆéšæœºæ£®æ—ï¼‰ï¼Œå¦‚æœdataset_info.yamlä¸­ç›¸åº”çš„æ•°æ®é›†å…·ä½“ä¿¡æ¯ä¸‹æ²¡æœ‰classifer_typeï¼Œåˆ™ä½¿ç”¨æ­¤å¤„è§„å®šçš„é»˜è®¤åˆ†ç±»å™¨
    classifer_type: "MLP"
    # mlpç›¸å…³é…ç½®
    mlp_dropout: 0.2
    mlp_lr: 0.0001
    mlp_epochs: 100
    save_last_epoch_model: False
    # RFç›¸å…³é…ç½®
    rf_n_estimators: 100
    # XGBç›¸å…³é…ç½®
    xgb_n_estimators: 100
    xgb_eval_metric: 'mlogloss'
    xgb_learning_rate: 0.1
    xgb_max_depth: 6
    # å•æ ·æœ¬ä¸­å¤šæ¡åºåˆ—embeddingçš„æ‹¼æ¥æ–¹å¼ï¼ˆ1ï¼šæ‹¼æ¥ eg:2x1024->1x2048ï¼Œ0ï¼šå¹³å‡æ± åŒ– eg:nx1024->1024ï¼‰
    pooled_embeddings_cat_dim: 1
   ```
- æŠ¥å‘Šç”Ÿæˆç›¸å…³
    ```yaml
    # ç»“æœä¿å­˜è·¯å¾„
    eval_result_path: "results_path" 
    # å¯æŠ¥å‘Šçš„åˆ†ç±»/æ ‡ç­¾æŒ‡æ ‡ï¼š ["accuracy","roc_auc","precision","recall","f1","mcc"]
    # å¯æŠ¥å‘Šçš„å›å½’æŒ‡æ ‡ï¼š ["r2","pearsonr","spearmanr"]
    # æå–æ¯ä¸ªæ•°æ®é›†ä¸­çš„æœ€ä½³ç»“æœï¼Œå¦‚æœè¯¥è¡Œåªå†™ä¸€ä¸ªæŒ‡æ ‡ï¼Œåˆ™æå–è¯¥æŒ‡æ ‡æœ€ä½³å±‚çš„æ‰€æœ‰ç»“æœï¼›å¦‚æœè¯¥è¡Œå†™å¤šä¸ªæŒ‡æ ‡ï¼Œåˆ™ä»æ‰€æœ‰å±‚ä¸­åˆ†åˆ«æå–è¿™äº›æŒ‡æ ‡çš„æœ€ä½³ç»“æœã€‚ç”Ÿæˆè¡¨æ ¼.
    target_best_table:
    - "accuracy"
    - "roc_auc"
    - ["roc_auc", "accuracy"]
    - "pearsonr"

    # ç»˜åˆ¶æ¯ä¸ªæ•°æ®é›†çš„æŠ˜çº¿å›¾ï¼Œæ¨ªè½´ä¸ºlayerï¼Œå¦‚æœè¯¥è¡Œåªæœ‰ä¸€ä¸ªæŒ‡æ ‡ï¼Œåˆ™ç»˜åˆ¶è¯¥æŒ‡æ ‡çš„æŠ˜çº¿å›¾ï¼›å¦‚æœè¯¥è¡Œå†™å¤šä¸ªæŒ‡æ ‡ï¼Œåˆ™ç¬¬ä¸€ä¸ªæŒ‡æ ‡ä¸ºä¸»æŒ‡æ ‡ï¼Œä»¥ä¸»æŒ‡æ ‡ç»˜å›¾ï¼Œå…¶ä½™ä¸ºå‰¯æŒ‡æ ‡ï¼Œå‰¯æŒ‡æ ‡åœ¨å›¾æ³¨ä¸­ï¼Œä¸ºä¸»æŒ‡æ ‡æœ€å¥½å±‚çš„å‰¯æŒ‡æ ‡å€¼ã€‚
    target_layer_line_figure:
    - ["roc_auc", "accuracy"]
    - ["accuracy", "roc_auc"]
    - "pearsonr"
   ```
- æ—¥å¿—ç›¸å…³ï¼Œç›®å‰åªæ”¯æŒmlpè¿‡ç¨‹ä¸­çš„wandbç›‘æ§
    ```yaml
    # å¦‚æœæµ‹è¯„ä»»åŠ¡è¾ƒå¤šï¼Œå¯èƒ½ä¼šäº§ç”Ÿè¾ƒå¤šç›‘æ§ï¼Œå¯ä»¥å°†wandb_reportè®¾ç½®ä¸ºFalse
    wandb_report: False
    wandb_project: "mlp"
    wandb_entity: "wandb_entity"
    wandb_online: False
   ```
- å…¶ä»–
    ```yaml
    seed: 42
   ```

## ğŸ”§ é«˜çº§ç”¨æ³•

### 1. ä»…ä½¿ç”¨é¢„æå–åµŒå…¥

å¦‚æœå‡ºäºå„ç§åŸå› è¯¥æµ‹è¯„æ¡†æ¶æ— æ³•å…¼å®¹å¾…æµ‹æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡å…¶å®ƒæ–¹å¼æå–embeddingï¼Œæ•´ç†æˆç›¸åº”çš„æ ¼å¼å¹¶ä¿®æ”¹configæ–‡ä»¶å³å¯ç»§ç»­ä½¿ç”¨æœ¬æ¡†æ¶
#### 1.1 ä¿®æ”¹`config.yaml`
```yaml
# æ³¨é‡Šæ‰model_pathï¼Œè®¾ç½®model_nameå’Œnum_layers
# model_path: "/path/to/model"
# å¡«å…¥æ¨¡å‹åç§°ï¼Œä¸»è¦ç”¨äºæ£€ç´¢ç»“æœæ–‡ä»¶
model_name: "your_model_name"
# å¡«å…¥æ¨¡å‹çš„å±‚æ•°ï¼Œè¿™ä¸ªä¸»è¦æ˜¯ç”¨äºæ£€ç´¢embeddingæ•°æ®
num_layers: 12
```
#### 1.2 embeddingæ–‡ä»¶æ ¼å¼
- æ–‡ä»¶å
`model_name/datasetname-[x]layer_[train/eval/test].pt`
- æ•°æ®æ ¼å¼
`{'embeddings':pooled_embeddings, 'labels':all_labels}`


### 2. è‡ªå®šä¹‰æ•°æ®é›†
#### 2.1 æ•°æ®é›†æ ¼å¼åŒ–
- æ–‡ä»¶å`model_name/[train/eval/test].jsonl`
- jsonlä¸­æ¯è¡Œæ•°æ®çš„æ ¼å¼`{"seq": "ATCG", "label": 0}`ï¼Œå¦‚æœæœ‰å¤šè¡Œæ•°æ®å¯å†™ä¸º`{"seq1": "ATCG", "seq2": "ATCG", "label": 0}`ï¼›åˆ†ç±»æ•°æ®çš„labelä¸ºæ•´å‹ï¼Œæ ‡ç­¾ä»»åŠ¡ä¸º[intï¼Œint], å›å½’ä»»åŠ¡ä¸º[float, float]

#### 2.2 åœ¨ `benchmarks/datasets_info.yaml` ä¸­æ·»åŠ æ–°çš„æ•°æ®é›†é…ç½®ï¼š

```yaml
  Human_classify_1048576:
    seq_for_item: 1   # ä¸€ä¸ªæ ·æœ¬ä¸­çš„åºåˆ—æ¡æ•°
    seq_key: seq      # æµ‹è¯•æ•°æ®é›†ä¸­åºåˆ—çš„keyï¼Œå¦‚æœä¸€ä¸ªæ ·æœ¬å¯¹åº”å¤šæ¡åºåˆ—ï¼Œåˆ™ä»¥åˆ—è¡¨å½¢å¼ç»„ç»‡å¤šä¸ªkeysï¼Œä¾‹å¦‚['seq1','seq2']
    label_key: label  # æµ‹è¯•æ•°æ®é›†ä¸­labelçš„key
    eval_task: classification  #ä»»åŠ¡ç±»å‹ï¼Œç›®å‰æœ‰åˆ†ç±»ä»»åŠ¡classificationï¼Œæ ‡ç­¾ä»»åŠ¡labelå’Œå›å½’ä»»åŠ¡regression
    data_split: ['train', 'test', 'eval']  # æ•°æ®é›†åˆ†å‰²æ–¹å¼
    dataset_ratio:  [0.79, 0.09, 0.12]  # æ•°æ®é›†åˆ†å‰²æ¯”ä¾‹ï¼Œä¸data_splité¡ºåºä¸€è‡´
    classifer_type: "XGB"   # æµ‹è¯„ç”¨åˆ†ç±»å™¨çš„ç±»å‹ï¼Œå¦‚æœä¸å†™åˆ™è·Ÿconfigä¸­çš„classifer_typeä¸€è‡´
    sample_num:  28802     # æ ·æœ¬æ•°é‡
    min_length:  1048576   # æœ€çŸ­åºåˆ—é•¿åº¦
    max_length:  1048576   # æœ€é•¿åºåˆ—é•¿åº¦
    dataset_ratio:  [0.79, 0.09, 0.12]  # æ•°æ®é›†åˆ†å‰²æ¯”ä¾‹
    label_train_counter:  [(0, 4507), (1, 10582), (2, 7837)] #è®­ç»ƒé›†å„æ ‡ç­¾æ•°é‡
    label_test_counter:  [(0, 392), (1, 1174), (2, 979)]     #æµ‹è¯•é›†å„æ ‡ç­¾æ•°é‡
    label_eval_counter:  [(0, 784), (1, 1568), (2, 979)]     #éªŒè¯é›†å„æ ‡ç­¾æ•°é‡
```
### 3. ä»»åŠ¡è°ƒåº¦é€»è¾‘
ä¸»è¦ç”±`config.yaml`æ–‡ä»¶ä¸­`process_power_per_gpu`ï¼Œ`embedding_process_power`ï¼Œ`eval_process_power`ï¼Œ`embedding_extract_split`è¿™å››ä¸ªå‚æ•°ï¼Œå‡å¯è‡ªå®šä¹‰ï¼Œå…¶ä¸­
- `process_power_per_gpu`ï¼Œ`embedding_process_power`ï¼Œ`eval_process_power`ç®¡ç†ä»»åŠ¡åˆ†é…ä¸è°ƒåº¦
- `embedding_extract_split`ç®¡ç†embeddingä»»åŠ¡åˆ†å‰²
#### 3.1 ä»»åŠ¡åˆ†é…
- `process_power_per_gpu`ä¸ºæ¯å¼ gpuæ‹¥æœ‰çš„æƒé‡æ•°
- `embedding_process_power`ä¸ºæ¯ä¸ªembeddingæå–ä»»åŠ¡æ‰€å ç”¨çš„æƒé‡æ•°
- `eval_process_power`ä¸ºè·å¾—embeddingä¹‹åï¼Œæ¯ä¸ªä¸‹æ¸¸ä»»åŠ¡æ‰€å ç”¨çš„æƒé‡æ•°
ä¾‹å¦‚ï¼Œ`process_power_per_gpu:5`ï¼Œ`embedding_process_power:2`ï¼Œ`eval_process_power:1`ï¼Œå‡è®¾åˆ™æ²¡æœ‰å·²æå–å¥½embeddingçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæœ‰2ä¸ªGPUï¼Œå¹¶ä¸”éœ€è¦å¤„ç†3ä¸ªæ•°æ®é›†ï¼ˆdataset_Aã€dataset_Bã€dataset_Cï¼‰ï¼Œä»»åŠ¡åˆ†é…è¿‡ç¨‹å¦‚ä¸‹ï¼š

**åˆå§‹çŠ¶æ€**ï¼š
```
GPU-0: æƒé‡è´Ÿè½½ 0/5  [ç©ºé—²]
GPU-1: æƒé‡è´Ÿè½½ 0/5  [ç©ºé—²]
embeddingä»»åŠ¡é˜Ÿåˆ—: [dataset_A, dataset_B, dataset_C]
evalä»»åŠ¡é˜Ÿåˆ—: []
```

**ç¬¬ä¸€è½®åˆ†é…**ï¼ˆä¼˜å…ˆåˆ†é…embeddingä»»åŠ¡ï¼‰ï¼š
- GPU-0è¢«åˆ†é…dataset_Açš„embeddingæå–ä»»åŠ¡ï¼Œæƒé‡è´Ÿè½½å˜ä¸º2/5
- GPU-1è¢«åˆ†é…dataset_Bçš„embeddingæå–ä»»åŠ¡ï¼Œæƒé‡è´Ÿè½½å˜ä¸º2/5
```
GPU-0: æƒé‡è´Ÿè½½ 2/5  [dataset_A embeddingæå–]
GPU-1: æƒé‡è´Ÿè½½ 2/5  [dataset_B embeddingæå–]
embeddingä»»åŠ¡é˜Ÿåˆ—: [dataset_C]
evalä»»åŠ¡é˜Ÿåˆ—: []
```

**ç¬¬äºŒè½®åˆ†é…**ï¼š
- GPU-0è¿˜å¯ä»¥æ‰¿æ‹…3ä¸ªæƒé‡çš„ä»»åŠ¡ï¼Œå¯ä»¥å†åˆ†é…ä¸€ä¸ªembeddingä»»åŠ¡
- GPU-0è¢«åˆ†é…dataset_Cçš„embeddingæå–ä»»åŠ¡ï¼Œæƒé‡è´Ÿè½½å˜ä¸º4/5
```
GPU-0: æƒé‡è´Ÿè½½ 4/5  [dataset_A embeddingæå–, dataset_C embeddingæå–]
GPU-1: æƒé‡è´Ÿè½½ 2/5  [dataset_B embeddingæå–]
embeddingä»»åŠ¡é˜Ÿåˆ—: []
evalä»»åŠ¡é˜Ÿåˆ—: []
```

**ä»»åŠ¡å®Œæˆä¸çº§è”åˆ†é…**ï¼š
- å½“dataset_Açš„embeddingæå–å®Œæˆåï¼ŒGPU-0é‡Šæ”¾2ä¸ªæƒé‡ï¼Œå˜ä¸º2/5
- dataset_Aè¢«è‡ªåŠ¨æ·»åŠ åˆ°evalä»»åŠ¡é˜Ÿåˆ—
- GPU-0å¯ä»¥åˆ†é…dataset_Açš„evalä»»åŠ¡ï¼ˆæƒé‡ä¸º1ï¼‰ï¼Œè´Ÿè½½å˜ä¸º3/5
```
GPU-0: æƒé‡è´Ÿè½½ 3/5  [dataset_C embeddingæå–, dataset_A evalè¯„ä¼°]
GPU-1: æƒé‡è´Ÿè½½ 2/5  [dataset_B embeddingæå–]
embeddingä»»åŠ¡é˜Ÿåˆ—: []
evalä»»åŠ¡é˜Ÿåˆ—: []
```

**æœ€ç»ˆä¼˜åŒ–çŠ¶æ€**ï¼š
éšç€å„ä»»åŠ¡é™†ç»­å®Œæˆï¼ŒGPUèµ„æºè¢«å……åˆ†åˆ©ç”¨ï¼š
```
GPU-0: æƒé‡è´Ÿè½½ 3/5  [dataset_B evalè¯„ä¼°, dataset_C evalè¯„ä¼°, å…¶ä»–ä»»åŠ¡]
GPU-1: æƒé‡è´Ÿè½½ 2/5  [æ–°çš„embeddingä»»åŠ¡æˆ–å¤šä¸ªevalä»»åŠ¡]
```

é€šè¿‡è¿™ç§æƒé‡æœºåˆ¶ï¼Œç³»ç»Ÿç¡®ä¿äº†ï¼š
1. **é¿å…èµ„æºè¶…è½½**ï¼šæ¯ä¸ªGPUçš„æƒé‡æ€»å’Œä¸ä¼šè¶…è¿‡é…é¢
2. **ä»»åŠ¡ä¼˜å…ˆçº§**ï¼šembeddingä»»åŠ¡ï¼ˆæƒé‡2ï¼‰ä¼˜å…ˆè·å¾—GPUèµ„æº
3. **è´Ÿè½½å‡è¡¡**ï¼šè‡ªåŠ¨é€‰æ‹©è´Ÿè½½æœ€è½»çš„GPUåˆ†é…æ–°ä»»åŠ¡
4. **çº§è”å¤„ç†**ï¼šembeddingå®Œæˆåè‡ªåŠ¨è§¦å‘ç›¸åº”çš„evalä»»åŠ¡

#### 3.2 embeddingä»»åŠ¡åˆ†å‰²

ä¸ºäº†ä¼˜åŒ–å†…å­˜ä½¿ç”¨å’Œæé«˜å¹¶è¡Œå¤„ç†æ•ˆç‡ï¼Œç³»ç»Ÿé‡‡ç”¨**æ•°æ®åˆ†å‰²æœºåˆ¶**æ¥å¤„ç†å¤§å‹æ•°æ®é›†çš„embeddingæå–ä»»åŠ¡ã€‚ä¸»è¦é€šè¿‡`embedding_extract_split`å‚æ•°æ§åˆ¶åˆ†å‰²ç²’åº¦ã€‚

##### **åˆ†å‰²ç­–ç•¥**
- `embedding_extract_split: 50000`è¡¨ç¤ºæ¯ä¸ªå­ä»»åŠ¡æœ€å¤šå¤„ç†50,000ä¸ªæ ·æœ¬
- å¯¹äºå¤§å‹æ•°æ®é›†ï¼Œä¼šè‡ªåŠ¨åˆ†å‰²æˆå¤šä¸ªè¾ƒå°çš„å­ä»»åŠ¡
- æ¯ä¸ªå­ä»»åŠ¡ç‹¬ç«‹åˆ†é…GPUèµ„æºï¼Œæé«˜å¹¶è¡Œæ•ˆç‡
é€šè¿‡è¿™ç§åˆ†å‰²æœºåˆ¶ï¼Œç³»ç»Ÿèƒ½å¤Ÿé«˜æ•ˆå¤„ç†ä»»æ„å¤§å°çš„æ•°æ®é›†ï¼ŒåŒæ—¶ä¿æŒæœ€ä½³çš„èµ„æºåˆ©ç”¨ç‡å’Œç¨³å®šæ€§ã€‚

---

**æ³¨æ„**: ä½¿ç”¨æœ¬å·¥å…·å‰ï¼Œè¯·ç¡®ä¿æ‚¨æœ‰è¶³å¤Ÿçš„è®¡ç®—èµ„æºå’Œå­˜å‚¨ç©ºé—´ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§å‹æ¨¡å‹å’Œæ•°æ®é›†æ—¶ã€‚åœ¨å¹³å°ã€ç¯å¢ƒç­‰å‘ç”Ÿå˜åŒ–åï¼Œæµ‹è¯„ç»“æœå¯èƒ½ä¼šäº§ç”Ÿè½»å¾®å·®åˆ«ã€‚
